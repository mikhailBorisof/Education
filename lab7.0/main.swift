//
//  main.swift
//  lab 7.0  –ì–ª–∞–≤–∞ 11 (—É–ø—Ä. 11.1)
//
//  Created by misha borisov on 14.05.2022.
//
/*    ---------------------------------------    */
// —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
func  helloUser() {
    print("\n Hello, Lab 7! \n  \n –í–∞—Ä–∏–∞–Ω—Ç N5")
    print(" –≠—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–µ–∞–ª–∏–∑—É—é—â–∞—è –∞–ª–≥–æ—Ä–∏—Ç–º \n –º–µ—Ç–æ–¥–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π (–º–µ—Ç–æ–¥–∞ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ), \n –≥–¥–µ –≤—Ö–æ–¥–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º, –∑–∞–¥–∞–≤–∞–µ–º—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å –∫–æ–Ω—Å–æ–ª–∏, \n —è–≤–ª—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø—ã—Ç–∞–Ω–Ω—ã–π, \n –∞ –≤—ã—Ö–æ–¥–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞ —Å–∏—Å—Ç–µ–º—ã\n")
    shellCommandStart( labName: "lab7.0") //  —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞
}
// —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã
func goodByeUser() {
    print("\n –î–æ—Å–≤–∏–¥–∞–Ω–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –µ—â—ë!")
    shellCommandStop() // —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞
    print(" ", terminator: "") // terminator - –ø–∞—Ä–∞–º–µ—Ç—Ä —Ç–æ–≥–æ, —á—Ç–æ –±—É–¥–µ—Ç –ø–æ—Å–ª–µ –ø–µ—á–∞—Ç–∏, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ("\n")
}
/*    ------------ –°–∞–º–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞, –ø–æ —Å—É—Ç–∏ main() ------------    */
import Foundation
var numExp:Int? // —á–∏—Å–ª–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
var numTries:Int? // —á–∏—Å–ª–æ –ø–æ–ø—ã—Ç–æ–∫ –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ
var m1,m2,m3,m4:Double // –∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏
var failureCount:Int = 0 // —á–∏—Å–ª–æ –æ—à–∏–±–æ–∫ –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ
let threshold1:Double = 0.1 // –ø–æ—Ä–æ–≥ –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ—à–∏–±–∫–∏
let threshold2:Double = 0.2 // –ø–æ—Ä–æ–≥ –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ—à–∏–±–∫–∏
let threshold3:Double = 0.3 // –ø–æ—Ä–æ–≥ –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ—à–∏–±–∫–∏
let threshold4:Double = 0.4 // –ø–æ—Ä–æ–≥ –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ—à–∏–±–∫–∏
var sum:Double = 0.0 // —Å—É–º–º–∞ —Å—Ä–µ–¥–Ω–∏—Ö –æ—à–∏–±–æ–∫ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

// –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞ —Å–∏—Å—Ç–µ–º—ã —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Ä–∞–≤–Ω–∞
// –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞ 1 + –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞ –≤—Ç–æ—Ä–æ–≥–æ,
// —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –Ω–µ –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
// + –µ—â–µ –æ–¥–∏–Ω –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –±–ª–æ–∫, —Å –¥–≤—É–º—è –∑–∞–≤–∏—Å–∏–º—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏,
// –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ —ç—Ç–æ
// 1 - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –æ–±–æ–∏—Ö —ç–ª–µ–º–Ω–µ—Ç–æ–≤ –≤–º–µ—Å—Ç–µ
let mathVer = threshold1 + threshold4 + (1 - (1 - threshold2)*(1 - threshold3))
helloUser() // –ø—Ä–∏–≤–µ—Ç—Å–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–≥—Ä–∞–º–º–µ
repeat{
    /* -------- –ë–ª–æ–∫ –≤–æ–ø—Ä–æ—Å–∞ –ß–∏—Å–ª–æ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ --------- */
    repeat{
        print(" –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –æ—Ç 1 –¥–æ 1000 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ")
        numExp = Optional (enterNumberUnsignedInt())
        
        if numExp! < 1 || numExp! > 1000 {
            print(" ‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –ù—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 1000 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ!")
            numExp = nil
        }
    } while numExp == nil // –µ—Å–ª–∏ –≤–≤–æ–¥ –Ω–µ —É–¥–∞–ª—Å—è, –ø—Ä–æ—Å–∏–º –≤–≤–µ—Å—Ç–∏ —Å–Ω–æ–≤–∞
    /* - –ë–ª–æ–∫ –≤–æ–ø—Ä–æ—Å–∞ –ß–∏—Å–ª–æ –ø–æ–ø—ã—Ç–æ–∫ –≤ –æ–¥–Ω–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ - */
    repeat{
        print(" –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –ø–æ–ø—ã—Ç–æ–∫ –≤ –æ–¥–Ω–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ –æ—Ç 100 –¥–æ 2000 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ")
        numTries = Optional (enterNumberUnsignedInt())
        
        if numTries! < 100 || numTries! > 2000  {
            print(" ‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –ù—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ –æ—Ç 100 –¥–æ 2000 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ!")
            numTries = nil
        }
    } while numTries == nil // –µ—Å–ª–∏ –≤–≤–æ–¥ –Ω–µ —É–¥–∞–ª—Å—è, –ø—Ä–æ—Å–∏–º –≤–≤–µ—Å—Ç–∏ —Å–Ω–æ–≤–∞
    print()
    /* ----------- –ë–ª–æ–∫ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∏—Å–ø—ã—Ç–∞–Ω–∏–π ---------- */
    // —Å—á–µ—Ç—á–∏–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
    sum = 0 // –æ–¥–Ω—É–ª–µ–Ω–∏–µ —Å—É–º–º—ã —Å—Ä–µ–¥–Ω–∏—Ö –æ—à–∏–±–æ–∫ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º
    /* ----------- –ë–ª–æ–∫ –≤—ã–≤–æ–¥–∞ —à–∞–ø–∫–∏ —Ç–∞–±–ª–∏—Ü—ã ---------- */
    print(" |-------------|---------------|")
    print(" | –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç |  –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å  |")
    print(" |    –Ω–æ–º–µ—Ä    |     –æ—Ç–∫–∞–∑–∞    |")
    print(" |             | —Å–∏—Å—Ç–µ–º—ã —Ä–∞–≤–Ω–∞ |")
    print(" |-------------|---------------|")
    /* ----------- –ë–ª–æ–∫ –≤—ã–≤–æ–¥–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∏—Å–ø—ã—Ç–∞–Ω–∏–π ---------- */
    for exp in 1...numExp! {
        failureCount = 0  // –æ–±–Ω—É–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–æ–≤–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ
        // —Å—á–µ—Ç—á–∏–∫ –∏—Å–ø—ã—Ç–∞–Ω–∏–π –≤ –æ–¥–Ω–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ
        for _ in 1...numTries! {
            var rng = SystemRandomNumberGenerator()
            m1 = Double.random(in: 0..<1, using: &rng)
            m2 = Double.random(in: 0..<1, using: &rng)
            m3 = Double.random(in: 0..<1, using: &rng)
            m4 = Double.random(in: 0..<1, using: &rng)
            // & - —Ä–∞–∑—ã–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è
            
            if m1 > threshold1 || ( m2 > threshold2 && m3 > threshold3 ) ||  m4 > threshold4 { failureCount += 1 }
        }
        /* ----------- –ë–ª–æ–∫ –≤—ã–≤–æ–¥–∞ –≤ –¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã ---------- */
        if exp < 10 {
            print(" |      \(exp)      |     \(NSString(format:"%.3f", Double(failureCount) / Double(numTries!)))     |")// NSString - –∫–ª–∞—Å—Å –æ–±–µ—Ä—Ç–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –º–µ—Ç–æ–¥—ã –∏–∑–º–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫
        }
        if 9 < exp && exp < 100 {
            print(" |     \(exp)      |     \(NSString(format:"%.3f", Double(failureCount) / Double(numTries!)))     |")// NSString - –∫–ª–∞—Å—Å –æ–±–µ—Ä—Ç–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –º–µ—Ç–æ–¥—ã –∏–∑–º–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫
        }
        if 99 < exp && exp < 1000 {
            print(" |    \(exp)      |     \(NSString(format:"%.3f", Double(failureCount) / Double(numTries!)))     |")// NSString - –∫–ª–∞—Å—Å –æ–±–µ—Ä—Ç–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –º–µ—Ç–æ–¥—ã –∏–∑–º–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫
        }
        if 999 < exp {
            print(" |   \(exp)      |     \(NSString(format:"%.3f", Double(failureCount) / Double(numTries!)))     |")// NSString - –∫–ª–∞—Å—Å –æ–±–µ—Ä—Ç–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –º–µ—Ç–æ–¥—ã –∏–∑–º–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫
        }
        sum += Double(failureCount) / Double(numTries!) // –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—É–º–º—ã —Å—Ä–µ–¥–Ω–∏—Ö –æ—à–∏–±–æ–∫ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
    }
    print(" |-------------|---------------|")
    print("\n üü¢ –°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞ —Å–∏—Å—Ç–µ–º—ã \n    —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–µ—Ç–æ–¥–æ–º –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Ä–∞–≤–Ω–∞: \(NSString(format:"%.3f", (sum / Double(numExp!))))")// NSString - –∫–ª–∞—Å—Å –æ–±–µ—Ä—Ç–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –º–µ—Ç–æ–¥—ã –∏–∑–º–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫
    print(" üü¢ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞ —Å–∏—Å—Ç–µ–º—ã \n    —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Ä–∞–≤–Ω–∞: \(NSString(format:"%.3f", mathVer))")
    print ( " üü¢ –ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç: \(NSString(format:"%.3f",100 - (mathVer / (sum / Double(numExp!)))*100)) %")
}
while isRepiat() // —Å–ø—Ä–æ—Å–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–µ —Ö–æ—á–µ—Ç –ª–∏ –æ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –µ—â–µ —Ä–∞–∑
goodByeUser() // –≤—ã—Ö–æ–¥ - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
